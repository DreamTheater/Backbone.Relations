/**
 * Backbone.Relations v0.1.7
 * https://github.com/DreamTheater/Backbone.Relations
 *
 * Copyright (c) 2013 Dmytro Nemoga
 * Released under the MIT license
 */
!function(){"use strict";var a=Backbone.Model;Backbone.Model=a.extend({_collection:Backbone.Collection.extend({initialize:function(){this.on("add",function(a,b,c){this.model.collection.add(a,c)}),this.on("remove",function(a,b,c){this.model.collection.remove(a,c)})}}),constructor:function(b,c){this._relations={},this.initialize=_.wrap(this.initialize,function(a,b,c){return a.call(this,b,c)}),a.call(this,b,c)},belongsTo:function(a,b){var c=b.foreignKey;return this._createRelation(a,{get:function(){var b=this.attributes[c];return a.collection.get(b)},set:function(a,b){return this.set(c,a.id,b)},build:function(b,c){return new a(b,c)},create:function(b,c){return a.collection.create(b,c)}},b),this},hasOne:function(a,b){var c=b.foreignKey;return this._createRelation(a,{get:function(){var b=this._makeHash(null,c);return a.collection.findWhere(b)},set:function(a,b){return a.set(c,this.id,b)},build:function(b,d){var e=this._makeHash(b,c);return new a(e,d)},create:function(b,d){var e=this._makeHash(b,c);return a.collection.create(e,d)}},b),this},hasMany:function(a,b){var c=b.foreignKey;return this._createRelation(a,{get:function(){var b=this._collection,d=this._makeHash(null,c),e=a.collection.where(d);return new b(e,{model:a})}},b),this},_createRelation:function(a,b,c){var d=c.as,e=d.charAt(0).toUpperCase()+d.substr(1),f=b.get,g=b.set,h=b.build,i=b.create;f&&(this["get"+e]=f),g&&(this["set"+e]=g),h&&(this["build"+e]=h),i&&(this["create"+e]=i),this._relations[d]={model:a,reference:b,options:c}},_makeHash:function(a,b){var c=_.clone(a)||{};return c[b]=this.id,c}})}(),function(){"use strict";var a=Backbone.Collection;Backbone.Collection=a.extend({model:Backbone.Model,constructor:function(b,c){this.initialize=_.wrap(this.initialize,function(a,b,c){return this.model.collection=this,a.call(this,b,c)}),a.call(this,b,c)}})}();